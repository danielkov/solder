{% for service_import in service_imports %}import { {{ service_import.name }}Service } from './{{ service_import.file }}';
{% endfor %}
/**
 * Describes the outgoing request. Mutate any field in `onRequest` to
 * alter the request before it is sent (e.g. add headers, rewrite URL).
 */
export interface SDKRequestInit {
  method: string;
  url: string;
  headers: Record<string, string>;
  body?: string;
}

/**
 * Read-only snapshot of the response returned by `fetch`.
 */
export interface SDKResponseInfo {
  method: string;
  url: string;
  status: number;
  headers: Headers;
}

/**
 * Hooks for intercepting SDK lifecycle events.
 * All hooks are optional.
 */
export interface SDKHooks {
  /** Called before each request is sent. Mutate `request` to add headers, rewrite the URL, etc. */
  onRequest?: (request: SDKRequestInit) => void | Promise<void>;
  /** Called after each response is received, before the body is parsed. */
  onResponse?: (response: SDKResponseInfo) => void | Promise<void>;
  /** Called when any API call results in an error, before the error is thrown. */
  onError?: (error: unknown) => void | Promise<void>;
}

{% if !auth_schemes.is_empty() %}/**
 * Security configuration for the SDK
 */
export interface SecurityConfig {
{% for auth in auth_schemes %}  {% if let Some(desc) = auth.docs.description %}/** {{ desc }} */
  {% endif %}{{ auth.name.camel }}?: string;
{% endfor %}}

{% endif %}/**
 * Options for constructing the SDK client.
 */
export interface {{ api.package_name.pascal }}SDKOptions {
  /** Base URL for API requests. Defaults to '{{ default_base_url }}'. */
  baseUrl?: string;
{% if !auth_schemes.is_empty() %}  /** Security credentials. */
  security?: SecurityConfig;
{% endif %}  /** Lifecycle hooks. */
  hooks?: SDKHooks;
}

{% if let Some(summary) = api.docs.summary %}/**
 * {{ summary }}
{% if let Some(description) = api.docs.description %} *
 * {{ description }}
{% endif %} *
 * @version {{ api.version }}
 */
{% endif %}export class {{ api.package_name.pascal }}SDK {
  {% for service in services %}private _{{ service.name.camel }}: {{ service.name.pascal }}Service | undefined;
  {% endfor %}
  private readonly baseUrl: string;
{% if !auth_schemes.is_empty() %}  private readonly security: SecurityConfig;
{% endif %}  private readonly hooks: SDKHooks;

  constructor(options: {{ api.package_name.pascal }}SDKOptions = {}) {
    this.baseUrl = options.baseUrl ?? '{{ default_base_url }}';
{% if !auth_schemes.is_empty() %}    this.security = options.security ?? {};
{% endif %}    this.hooks = options.hooks ?? {};
  }

{% for service in services %}  {% if let Some(summary) = service.docs.summary %}/**
   * {{ summary }}
   */
  {% endif %}get {{ service.name.camel }}(): {{ service.name.pascal }}Service {
    if (!this._{{ service.name.camel }}) {
      this._{{ service.name.camel }} = new {{ service.name.pascal }}Service(this.baseUrl, {% if !auth_schemes.is_empty() %}this.security, {% endif %}this.hooks);
    }
    return this._{{ service.name.camel }};
  }

{% endfor %}}
